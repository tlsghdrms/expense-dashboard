<%- include('./include/_header') %>

<div class="container" style="max-width: 500px; margin: 60px auto; padding: 0 20px;">
    <div style="text-align: center; margin-bottom: 40px;">
        <h2 style="color: #333; margin-bottom: 10px;">ğŸ‘¤ ë§ˆì´í˜ì´ì§€</h2>
        <p style="color: #666;">íšŒì› ì •ë³´ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ íƒˆí‡´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>

    <div style="background: #fff; padding: 40px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid #eee;">
        
        <form action="/users/mypage?_method=PUT" method="POST" id="updateForm">
            
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="username" style="display: block; margin-bottom: 8px; font-weight: 600; color: #444;">ì•„ì´ë”” (ìˆ˜ì • ë¶ˆê°€)</label>
                <input 
                    type="text" 
                    id="username" 
                    name="username" 
                    value="<%= user.username %>" 
                    readonly
                    style="width: 100%; padding: 12px; border: 1px solid #ddd; background-color: #f5f5f5; color: #888; border-radius: 6px; box-sizing: border-box;"
                />
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label for="newPassword" style="display: block; margin-bottom: 8px; font-weight: 600; color: #444;">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                <input 
                    type="password" 
                    id="newPassword" 
                    name="newPassword" 
                    placeholder="ë³€ê²½í•  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" 
                    required
                    style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box;"
                />
            </div>

            <div class="form-group" style="margin-bottom: 30px;">
                <label for="confirmPassword" style="display: block; margin-bottom: 8px; font-weight: 600; color: #444;">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input 
                    type="password" 
                    id="confirmPassword" 
                    name="confirmPassword" 
                    placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”" 
                    required
                    style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box;"
                />
                <p id="pw-msg" style="margin-top: 5px; font-size: 0.85rem; color: #dc3545; display: none;">ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
            </div>

            <div style="display: flex; gap: 10px;">
                <button type="submit" class="btn btn-primary" 
                    style="flex: 1; padding: 12px; background-color: #036b3f; color: white; border: none; border-radius: 6px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: background 0.2s;">
                    ì •ë³´ ìˆ˜ì •í•˜ê¸°
                </button>
        </form>
                
                <form action="/users/withdraw?_method=DELETE" method="POST" style="margin: 0; flex: 0.4;"
                    onsubmit="return confirm('ì •ë§ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì‘ì„±í•œ ëª¨ë“  ì§€ì¶œ ë‚´ì—­ì´ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.');">
                    <button type="submit" style="
                        width: 100%; 
                        padding: 12px; 
                        background-color: #fff; 
                        color: #dc3545; 
                        border: 1px solid #dc3545; 
                        border-radius: 6px; 
                        font-size: 1rem; 
                        font-weight: 600; 
                        cursor: pointer; 
                        transition: all 0.2s;
                    " onmouseover="this.style.backgroundColor='#dc3545'; this.style.color='#fff';" 
                      onmouseout="this.style.backgroundColor='#fff'; this.style.color='#dc3545';">
                        íšŒì›íƒˆí‡´
                    </button>
                </form>
            </div>

    </div>
</div>

<script>
    // í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ í™•ì¸
    const newPw = document.getElementById('newPassword');
    const confirmPw = document.getElementById('confirmPassword');
    const msg = document.getElementById('pw-msg');
    const updateForm = document.getElementById('updateForm');

    function checkPassword() {
        if(confirmPw.value && newPw.value !== confirmPw.value) {
            msg.style.display = 'block';
            confirmPw.style.borderColor = '#dc3545';
        } else {
            msg.style.display = 'none';
            confirmPw.style.borderColor = '#ddd';
        }
    }

    newPw.addEventListener('input', checkPassword);
    confirmPw.addEventListener('input', checkPassword);

    updateForm.addEventListener('submit', function(e) {
        if (newPw.value !== confirmPw.value) {
            e.preventDefault();
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
    });
</script>

<%- include('./include/_footer') %>