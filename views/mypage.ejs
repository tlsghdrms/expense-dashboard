<%- include('./include/_header') %>

<div class="mypage-container">
    <div class="mypage-header">
        <h2 class="mypage-title">ğŸ‘¤ ë§ˆì´í˜ì´ì§€</h2>
        <p class="mypage-desc">íšŒì› ì •ë³´ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ íƒˆí‡´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>

    <div class="mypage-card">
        <form action="/users/mypage?_method=PUT" method="POST" id="updateForm">
            <div class="mypage-form-group">
                <label for="username" class="mypage-label">ì•„ì´ë”” (ìˆ˜ì • ë¶ˆê°€)</label>
                <input type="text" id="username" name="username" value="<%= user.username %>" readonly class="mypage-input">
            </div>

            <div class="mypage-form-group">
                <label for="newPassword" class="mypage-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="newPassword" name="newPassword" placeholder="ë³€ê²½í•  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required class="mypage-input">
            </div>

            <div class="mypage-form-group last">
                <label for="confirmPassword" class="mypage-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input type="password" id="confirmPassword" name="confirmPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”" required class="mypage-input">
                <p id="pw-msg" class="error-msg">ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
            </div>
        </form> 
        
        <div class="mypage-btn-group">
            <button type="submit" form="updateForm" class="btn-mypage-submit">ì •ë³´ ìˆ˜ì •í•˜ê¸°</button>
            
            <form action="/users/withdraw?_method=DELETE" method="POST" class="withdraw-form"
                onsubmit="return confirm('ì •ë§ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì‘ì„±í•œ ëª¨ë“  ì§€ì¶œ ë‚´ì—­ì´ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.');">
                <button type="submit" class="btn-mypage-withdraw">íšŒì›íƒˆí‡´</button>
            </form>
        </div>
    </div>
</div>

<script>
    const newPw = document.getElementById('newPassword');
    const confirmPw = document.getElementById('confirmPassword');
    const msg = document.getElementById('pw-msg');
    const updateForm = document.getElementById('updateForm');

    function checkPassword() {
        if(confirmPw.value && newPw.value !== confirmPw.value) {
            msg.style.display = 'block';
            confirmPw.style.borderColor = '#dc3545';
        } else {
            msg.style.display = 'none';
            confirmPw.style.borderColor = '#ddd';
        }
    }

    newPw.addEventListener('input', checkPassword);
    confirmPw.addEventListener('input', checkPassword);

    updateForm.addEventListener('submit', function(e) {
        if (newPw.value !== confirmPw.value) {
            e.preventDefault();
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
    });
</script>

<%- include('./include/_footer') %>